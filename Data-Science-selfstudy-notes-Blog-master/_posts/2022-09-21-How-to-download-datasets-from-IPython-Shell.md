---
keywords: fastai
description: This blog post will show you how to download datasets from DataCamp Ipython Shell/Console in a web browser.
title: How to download datasets from IPython Shell in Datacamp
toc: true
branch: master
badges: true
comments: true
author: Datacamp
categories: [DataCamp, Dataset, Download, IPython Shell]
image: images/datacamp.png
hide: false
search_exclude: true
metadata_key1: metadata_value1
metadata_key2: metadata_value2
nb_path: _notebooks/How to download dataset from IPython Shell/2022-09-21-How to download datasets from IPython Shell.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/How to download dataset from IPython Shell/2022-09-21-How to download datasets from IPython Shell.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><strong>TL;DR:</strong> Use the python <a href="#Full-Code">script</a> to extract the link to download the targeting datasets from IPython Shell.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Motivation</strong>: While studying DataCamp courses, there were so many times that I could not reproduce the course results in my local environment with the provided datasets, which was quite frustrating. I had tried to reach out to the support team, but the results were not satisfactory. After spending hours searching on Stackoverflow <a href="https://stackoverflow.com/questions/31893930/download-csv-from-an-ipython-notebook">here</a> and <a href="https://stackoverflow.com/questions/26497912/trigger-file-download-within-ipython-notebook">there</a>, then trying and failing numerous times with several scripts, I could finally manage to download the dataset that the course was using.</p>
<p>I decided to share my workaround here. Hopefully, it could help everyone who is facing the same problems. <br></p>
<p>I have summarized how I did it in the following steps:</p>
<ul>
<li><a href="#Quick-EDA"><strong>1.</strong></a> Check the general info of the dataset</li>
<li><a href="#Save-the-dataset-to-the-cloud-storage"><strong>2.</strong></a> Put the download script to the script.py</li>
<li><a href="#Encode-the-file-data-and-an-generate-HTML-link"><strong>3.</strong></a> Extract the "href "link, and download it.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Quick-EDA">Quick EDA<a class="anchor-link" href="#Quick-EDA"> </a></h2><p>Run the following command to take do a quick check on the data</p>
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

                   <span class="n">y</span>
<span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>  <span class="mf">1.624345</span>
<span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span> <span class="o">-</span><span class="mf">0.936625</span>
<span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span>  <span class="mf">0.081483</span>
<span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">04</span> <span class="o">-</span><span class="mf">0.663558</span>
<span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">05</span>  <span class="mf">0.738023</span>
</pre></div>
<p>then a quick look with <code>df.info()</code></p>
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>


<span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="s1">&#39;&gt;</span>
<span class="n">DatetimeIndex</span><span class="p">:</span> <span class="mi">1000</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">2013</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="n">to</span> <span class="mi">2015</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">27</span>
<span class="n">Freq</span><span class="p">:</span> <span class="n">D</span>
<span class="n">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">1</span> <span class="n">columns</span><span class="p">):</span>
 <span class="c1">#   Column  Non-Null Count  Dtype  </span>
<span class="o">---</span>  <span class="o">------</span>  <span class="o">--------------</span>  <span class="o">-----</span>  
 <span class="mi">0</span>   <span class="n">y</span>       <span class="mi">1000</span> <span class="n">non</span><span class="o">-</span><span class="n">null</span>   <span class="n">float64</span>
<span class="n">dtypes</span><span class="p">:</span> <span class="n">float64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">memory</span> <span class="n">usage</span><span class="p">:</span> <span class="mf">55.6</span> <span class="n">KB</span>
<span class="kc">None</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Okay, the dataset has 1000 rows, with Freq set as Date, Dtype = float64, etc.</p>
<p>Here are the first 5 rows of data:</p>
<div class="highlight"><pre><span></span><span class="go">2013-01-01  1.624345</span>
<span class="go">2013-01-02 -0.936625</span>
<span class="go">2013-01-03  0.081483</span>
<span class="go">2013-01-04 -0.663558</span>
<span class="go">2013-01-05  0.738023</span>
</pre></div>
<p>We will remember this, so we can check later once we download the dataset to our local environment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Save-the-dataset-to-the-cloud-storage">Save the dataset to the cloud storage<a class="anchor-link" href="#Save-the-dataset-to-the-cloud-storage"> </a></h2><p>Next, we will save the dataset from the DataFrame to the cloud storage. Try the following code in the script.py.</p>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/tempsnip.png" alt=""></p>
<p>CODE:</p>
<div class="highlight"><pre><span></span><span class="c1"># Get the filename fullpath</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;data.csv&quot;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="n">filename</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
<p><br></p>
<p>Check the result by typing the following commands to the IPython Shell: <br></p>
<div class="highlight"><pre><span></span><span class="go">!pwd</span>
<span class="go">!ls</span>
</pre></div>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/tempsnip2.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Encode-the-file-data-and-an-generate-HTML-link">Encode the file data and an generate HTML link<a class="anchor-link" href="#Encode-the-file-data-and-an-generate-HTML-link"> </a></h2><p>Next, we run the following code, to generate HTML data.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="n">in_file</span>  <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="n">csv</span> <span class="o">=</span> <span class="n">in_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="c1"># print(csv) # Uncomment this if you want to check the csv content</span>
<span class="n">in_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">csv</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">=</span> <span class="n">b64</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
<span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;a download=&quot;</span><span class="si">{filename}</span><span class="s1">&quot; href=&quot;data:text/csv;base64,</span><span class="si">{payload}</span><span class="s1">&quot; target=&quot;_blank&quot;&gt;</span><span class="si">{title}</span><span class="s1">&lt;/a&gt;&#39;</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
<span class="c1"># Print the link</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;data:text/csv;base64,</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
</pre></div>
<p><br></p>
<p><strong>Result:</strong> <br></p>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/tempsnip3.png" alt=""></p>
<p>Paste the extracted link in the Shell output to a new tab in the browser. 
<br></p>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/tempsnip4.PNG" alt="">
<br></p>
<p><strong>Voila</strong>! That is the dataset that we want. <br></p>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/tempsnip5.PNG" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Check-the-downloaded-dataset-in-your-local-Jupyter-notebook">Check the downloaded dataset in your local Jupyter notebook<a class="anchor-link" href="#Check-the-downloaded-dataset-in-your-local-Jupyter-notebook"> </a></h2><p>Use this code: <br></p>
<div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./datasets/download.csv&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>  <span class="c1"># Set the frequent as DATE </span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
<p>then <br></p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
<p>Results: <br></p>
<p><img src="/Data-Science-selfstudy-notes-Blog/images/copied_from_nb/./images/tempsnip6.PNG" alt=""></p>
<p><br></p>
<p>As you can see, the downloaded dataset looks exactly like what we saw in the quick <a href="#quick-eda">EDA</a> section. You can now freely run your experiment locally with no worries about preprocessing the raw datasets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Full-Code">Full Code<a class="anchor-link" href="#Full-Code"> </a></h2><p>Here is the full code of the post. Use this script in the script.py, you should be able to download the targeted datasets.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>


<span class="k">def</span> <span class="nf">create_download_link</span><span class="p">(</span> <span class="n">df</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Download CSV file&quot;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;data.csv&quot;</span><span class="p">):</span>

    <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="n">filename</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="n">in_file</span>  <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
    <span class="n">csv</span> <span class="o">=</span> <span class="n">in_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="c1"># print(csv) # Uncomment this if you want to check the csv content</span>
    <span class="n">in_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">csv</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="n">b64</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;a download=&quot;</span><span class="si">{filename}</span><span class="s1">&quot; href=&quot;data:text/csv;base64,</span><span class="si">{payload}</span><span class="s1">&quot; target=&quot;_blank&quot;&gt;</span><span class="si">{title}</span><span class="s1">&lt;/a&gt;&#39;</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
    <span class="c1"># print the link</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;data:text/csv;base64,</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="n">create_download_link</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><strong>BONUS</strong>:&nbsp; Here is another version of the code. It was modified to help downloading numpy arrays. <br></p>
</blockquote>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>


<span class="k">def</span> <span class="nf">create_download_link</span><span class="p">(</span> <span class="n">numpy_arr</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Download CSV file&quot;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;data.csv&quot;</span><span class="p">):</span>
    <span class="c1"># CONVERT numpy array to pandas frame. </span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">numpy_arr</span><span class="p">)</span> 

    <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="n">filename</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="n">in_file</span>  <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
    <span class="n">csv</span> <span class="o">=</span> <span class="n">in_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="c1"># print(csv) # Uncomment this if you want to check the csv content</span>
    <span class="n">in_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">csv</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="n">b64</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">html</span> <span class="o">=</span> <span class="s1">&#39;&lt;a download=&quot;</span><span class="si">{filename}</span><span class="s1">&quot; href=&quot;data:text/csv;base64,</span><span class="si">{payload}</span><span class="s1">&quot; target=&quot;_blank&quot;&gt;</span><span class="si">{title}</span><span class="s1">&lt;/a&gt;&#39;</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">payload</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
    <span class="c1"># print the link</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;data:text/csv;base64,</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">HTML</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="n">create_download_link</span><span class="p">(</span><span class="n">new_inputs</span><span class="p">)</span>
</pre></div>
<p>Then we can reload the downloaded numpy array as follows.</p>
<div class="highlight"><pre><span></span><span class="n">new_inputs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./datasets/data.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">new_inputs</span> <span class="o">=</span> <span class="n">new_inputs_df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">new_inputs</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">100</span><span class="p">,))</span>  <span class="c1"># CONVERT it back to its original shape.</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><strong>OTHER NOTE:</strong> &nbsp; To see the pre-defined function from the scripts.py use the following script:
<br></p>
</blockquote>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">inspect</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">pre_defined_fucntion_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><strong>UPDATE (2022 Oct 13)</strong> <br></p>
</blockquote>
<p>In the above methods, it seems like that <strong>base64.b64encode</strong> create a TOO LONG string data when encoding the large table (Ex:Tables have more than 6500 rows). The download link is too long, and therefore nolonger possible to be loaded by the browser. The data will be lost if we use the above method. It will be trickier to download the data in these cases without encoding data with base64. 
One can think of using some string compression method to make the string shorter, but that is not feasible when huge tables present.</p>
<p>As an alternative, we can download the csv data as string in bytes format by:</p>
<ul>
<li>Manually copying data from the terminal</li>
<li>Save it as .txt format</li>
<li>Finally, reload it back to the original form. </li>
</ul>
<p>In details:</p>
<ul>
<li><strong>STEP 1:</strong> Download the data as "data.txt" file. <br></li>
</ul>
<div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">numpy_arr</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="k">def</span> <span class="nf">create_download_link</span><span class="p">(</span><span class="n">numpy_arr</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;data.csv&quot;</span><span class="p">):</span>
    <span class="c1"># CONVERT numpy array to pandas frame. </span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">numpy_arr</span><span class="p">)</span> 

    <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="n">filename</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">in_file</span><span class="p">:</span>
        <span class="n">csv_data</span> <span class="o">=</span> <span class="n">in_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="c1"># print(&quot;data:text/csv;charset=utf-8,{}&quot;.format(csv_data)) --&gt; not working since &#39;\\n&#39; is not the actual new line char anymore. </span>
        <span class="c1"># print(&quot;data:text/plain;charset=utf-8,{}&quot;.format(csv_data)) # save the byte data as plain text</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">csv_data</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># if the browser can not cover all character, we ll paste the data to .txt file directly </span>

<span class="n">create_download_link</span><span class="p">(</span><span class="n">abnormal</span><span class="p">)</span>
</pre></div>
<ul>
<li><strong>STEP 2:</strong> Load the "data.txt" file, and convert it back to normal csv format file. <br></li>
</ul>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">csv</span><span class="o">,</span> <span class="nn">os</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;./datasets/all_prices.txt&#39;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">plain_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">plain_str</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">plain_str</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:])</span>

    <span class="c1"># remove byte traces</span>
    <span class="n">csv_data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*?b\&#39;(.*)\&#39;.*?&quot;</span><span class="p">,</span> <span class="n">plain_str</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;START:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">csv_data</span><span class="p">[:</span><span class="mi">250</span><span class="p">],</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">END:&quot;</span><span class="p">,</span> <span class="n">csv_data</span><span class="p">[</span><span class="o">-</span><span class="mi">250</span><span class="p">:])</span>

    <span class="c1"># remove \\n with actual new line chars</span>
    <span class="n">csv_data</span> <span class="o">=</span> <span class="n">csv_data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">n&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;START:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">csv_data</span><span class="p">[:</span><span class="mi">250</span><span class="p">],</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">END:&quot;</span><span class="p">,</span> <span class="n">csv_data</span><span class="p">[</span><span class="o">-</span><span class="mi">250</span><span class="p">:])</span>

    <span class="c1"># update csv format to the filename</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file_path</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
        <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">csv_data</span><span class="p">)</span>
</pre></div>
<ul>
<li><strong>STEP 3:</strong>  Load the csv data as usual, we can also convert it to numpy array if we want. <br></li>
</ul>
<div class="highlight"><pre><span></span><span class="c1"># Read in the data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./datasets/data.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">())</span>

<span class="n">new_np_arr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_np_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That's it. Thank you for reading. If you find the blog post useful, please give the <a href="https://github.com/anhhaibkhn/Data-Science-selfstudy-notes-Blog">GitHub blog repo</a> a star to show your support and share it with others. Also, please let me know in the comments section of the post if you have any questions.</p>

</div>
</div>
</div>
</div>
 

